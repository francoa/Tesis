% Appendix Template

\chapter{OVITO} % Main appendix title

\label{AB} % Change X to a consecutive letter; for referencing this appendix elsewhere, use \ref{AppendixX}

\lhead{Anexo B. \emph{OVITO}} % Change X to a consecutive letter; this is for the header on each page - perhaps a shortened title

Ciertas imágenes (por ejemplo las figuras \ref{C4:fg:fcc_tension_bmg_10K} y \ref{C5:fg:ss_comp}) fueron realizadas utilizando el software Ovito \citep{stukowski10}. En el presente apéndice explicaremos cómo obtener dichas imágenes y daremos recomendaciones para mejorar el uso del software. Como condición previa es necesario haber instalado y ejecutado LAMMPS (Apéndice \ref{AA}), ya que Ovito trabaja, entre otras cosas, con los archivos de salida de éste.

\section{Instalación}
\label{AB_1}

Ovito es una software libre para la visualización. Es posible descargarlo para diversas plataformas en el \href{http://www.ovito.org/index.php/download}{sitio web}. Siendo usuarios linux, explicaremos únicamente para un sistema operativo tipo linux.

La instalación de Ovito es considerablemente más sencilla que la de LAMMPS. Basta con descomprimir el archivo descargado y ejecutar \textit{bin/ovito}. Sin embargo puede ser útil copiar las carpetas \textit{bin}, \textit{lib} y \textit{share} a \textit{usr/local/} para poder acceder a los ejecutables a través de línea de comando sin tener que acceder a la carpeta descargada.

En ocasiones puede ser útil descargar el código fuente, puesto que podemos contar con actualizaciones del código de Ovito para las cuales tendríamos que esperar hasta que se presente la siguiente versión estable. Para ello, accedemos al \href{http://sourceforge.net/p/ovito/git/ci/master/tree/}{repositorio Git en Sourceforge.net}, descargamos el archivo y seguimos las \href{http://www.ovito.org/manual/development.build_linux.html}{instrucciones}.

\begin{lstlisting}
sudo apt-get install build-essential git cmake-curses-gui qt5-default libcgal-dev libboost-dev \
		     libqt5scintilla2-dev libavcodec-dev libavdevice-dev libavfilter-dev \
		     libavformat-dev libavresample-dev libavutil-dev libswscale-dev libnetcdf-dev \
		     libhdf5-dev libhdf5-serial-dev libbotan1.10-dev libmuparser-dev python3-dev \
		     libboost-python-dev python3-sphinx python3-numpy xsltproc docbook-xml \
		     docbook-xsl docbook-xsl-doc-html doxygen
                     
cd ovito
mkdir build
cd build
cmake -DOVITO_BUILD_DOCUMENTATION=ON \
      -DCMAKE_BUILD_TYPE=Release \
      -DPYTHON_INCLUDE_DIR=/usr/include/python3.4m \
      -DPYTHON_LIBRARY=/usr/lib/x86_64-linux-gnu/libpython3.4m.so \
      -DBoost_PYTHON_LIBRARY_RELEASE=/usr/lib/x86_64-linux-gnu/libboost_python-py34.so \
      -DBoost_PYTHON_LIBRARY_DEBUG=/usr/lib/x86_64-linux-gnu/libboost_python-py34.so \
      ..
      
make -j4
\end{lstlisting}

\section{Análisis de archivos de LAMMPS}
\label{AB_2}

Para esta sección hemos realizado un video explicativo. El mismo puede observarse \href{www.github.com}{aquí???}.

\section{Automatización}
\label{AB_3}

Una herramienta poderosa para automatizar el cálculo es utilizar scripts. En la carpeta \textit{bin} de ovito hay un ejecutable (\textit{ovito}) y un script bash (\textit{\href{http://www.ovito.org/manual/python/introduction/running.html}{ovitos}}). Este último sirve para interpretar scripts escritos en lenguaje \textit{python}. 

En el \href{www.github.com}{sitio web???} de la Tesis es posible encontrar un script de ejemplo llamado \textit{Ovito\_scriptDePrueba.py}. El mismo importa archivos de una simulación de una muestra porosa presentes en la carpeta \textit{datasets}, y luego calcula la porosidad y el número de átomos con un \textit{atomic strain} superior a 0.2 a lo largo de la simulación. Estos cálculos se presentan en 2 columnas en un archivo de salida llamado \textit{Ovito\_scriptDePrueba.out}, el cual puede ser utilizado posteriormente para graficar con gnuplot.

\begin{lstlisting}
 ovitos Ovito_scriptDePrueba.py
 gnuplot
 plot 'Ovito_scriptDePrueba.out' using 1:2 with lines
 plot 'Ovito_scriptDePrueba.out' using 1:3 with lines
\end{lstlisting}

Para armar el dataset presente en el sitio web, fue necesario adecuar los archivos de salida de LAMMPS para que éstos no tuvieran un tamaño tan grande. Se les quitó todos los campos calculados por LAMMPS excepto los campos de posición, id y tipo. Esto fue realizado mediante un script \textit{bash}, utilizando el comando \textit{awk}. Estos scripts serán explicados con mayor detalle en el apéndice \ref{AC}???.

\begin{lstlisting}
#!/bin/bash

for ITERATOR in {0..400000..5000}
do
	FILEIN="Compression_porous_9_"$ITERATOR".lammpstrj"
	FILEOUT="dataset_muestraPorosa/MuestraPorosa_"$ITERATOR".lammpstrj"
	awk 'BEGIN{} {if (NR<=8){print $1 " " $2 " " $3 " " $4 " " $5 " " $6;} else if (NR==9)\
	  {print $1 " " $2 " " $3 " " $4 " " $5 " " $12 " " $13;} else{print $1 " " $2 " " $3 \
	  " " $10 " " $11;}}' $FILEIN > $FILEOUT
done
\end{lstlisting}

